- route:
    id: route-5efd
    from:
      id: from-fbf6
      uri: kamelet:spring-rabbitmq-source
      parameters:
        host: rabbitmq
        port: 5672
        queues: orders.requests
        routingKey: orders.exchange
        exchangeName: orders.exchange
        username: guest
        password: guest
      steps:
        - doTry:
            id: doTry-7270
            steps:
              - setHeader:
                  id: setHeader-7a8b
                  name: correlationId
                  expression:
                    simple:
                      id: simple-78d2
                      expression: ${header.CamelRabbitmqCorrelationId}
              - setHeader:
                  id: setHeader-eeec
                  name: Content-Type
                  expression:
                    constant:
                      id: constant-bcf0
                      expression: application/json
              - to:
                  id: to-40d7
                  uri: http
                  parameters:
                    httpMethod: POST
                    httpUri: http://erp:4004/odata/v4/simple-erp/Orders
              - to:
                  id: to-90e9
                  uri: kamelet:spring-rabbitmq-sink
                  parameters:
                    host: rabbitmq
                    port: 5672
                    exchangeName: amq.direct
                    queues: orders.responses
                    routingKey: orders.responses
        - doCatch:
            "0":
              exception: java.lang.Exception
              steps:
                - to:
                    uri: kamelet:spring-rabbitmq-sink
                    parameters:
                      host: rabbitmq
                      port: 5672
                      queues: orders.dlq
            id: doCatch-d27d
